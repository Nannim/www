!function(t){var o=window.imkt||(window.imkt={});o.utils=o.utils||{},o.sourcetree=o.sourcetree||{},o.sourcetree.Homepage=function(o,a){this.$domRoot=t("body"),this.$navbarCTA=t("#navDownloadButton",this.$domRoot),this.$buttonHero=t(".product-tour-hero--video__button .button",this.$domRoot),this.$linkHero=t(".product-tour-hero--video__link--secondary .cms-link",this.$domRoot),this.$buttonPrimary=t(".button--primary-download",this.$domRoot),this.$buttonSecondary=t(".button--secondary-download",this.$domRoot),this.$buttonDownloadAgain=t(".download--again",this.$domRoot),this.downloadUrlMac=this.$buttonHero.attr("href"),this.downloadUrlWindows=this.$linkHero.attr("href"),this.STRING_MAC="Mac OS X",this.STRING_WINDOWS="Windows",this.init()},o.sourcetree.Homepage.prototype={init:function(){t("body").hasClass("edit")||this.bindEvents()},bindEvents:function(){var a=this,i=[this.$navbarCTA,this.$buttonHero,this.$linkHero,this.$buttonPrimary,this.$buttonSecondary];this.setDefaultDataAttributes(),o.utils.browser.isWindows()&&this.swapDownloadLinks(),i.forEach(function(o){t(o).on("click",function(o){var i=o.currentTarget.href.split("?")[0];t(".download-area").hide(),t(a.$navbarCTA).hide(),t(".post-download-area").show(),t(window).scrollTop(0),t(a.$buttonDownloadAgain).attr("href",i),t(a.$buttonDownloadAgain).data("platform",t(o.currentTarget).data("platform")),a.trackEvent(o),window.analytics.page({actualUrl:"https://www.sourcetreeapp.com/download",path:"/download",url:"https://www.sourcetreeapp.com/download",referrer:window.location.href})})}),t(a.$buttonDownloadAgain).on("click",function(t){a.trackEvent(t)})},trackEvent:function(t){window.analytics&&window.analytics.track("Started Download",this.buildTrackingData(t.currentTarget))},setDefaultDataAttributes:function(){this.$buttonPrimary.data("platform",this.STRING_MAC),this.$buttonSecondary.data("platform",this.STRING_WINDOWS),this.$buttonHero.data("platform",this.STRING_MAC),this.$linkHero.data("platform",this.STRING_WINDOWS),this.$navbarCTA.data("platform",this.STRING_MAC),this.$buttonDownloadAgain.data("platform",this.STRING_MAC)},swapDownloadLinks:function(){var t=this.$buttonHero.text(),o=this.$linkHero.text();this.$buttonHero.attr("href",this.downloadUrlWindows).text(t.replace(this.STRING_MAC,this.STRING_WINDOWS)),this.$linkHero.attr("href",this.downloadUrlMac).text(o.replace(this.STRING_WINDOWS,this.STRING_MAC)),this.$buttonHero.data("platform",this.STRING_WINDOWS),this.$linkHero.data("platform",this.STRING_MAC),this.$buttonPrimary.attr("href",this.downloadUrlWindows).text(t.replace(this.STRING_MAC,this.STRING_WINDOWS)),this.$buttonSecondary.attr("href",this.downloadUrlMac).text(o.replace(this.STRING_WINDOWS,this.STRING_MAC)),this.$buttonPrimary.data("platform",this.STRING_WINDOWS),this.$buttonSecondary.data("platform",this.STRING_MAC),this.$navbarCTA.attr("href",this.downloadUrlWindows),this.$navbarCTA.data("platform",this.STRING_WINDOWS),this.$buttonDownloadAgain.data("platform",this.STRING_WINDOWS)},getFileName:function(t){var o;try{o=t.substr(t.lastIndexOf("/")+1)}catch(t){o="Unknown"}return o},buildTrackingData:function(a){var i=t(a).attr("href").split("?")[0];return{productName:"SourceTree",productPlatform:t(a).data("platform"),fileName:this.getFileName(i),fileUrl:i,optimizelyBuckets:o.utils.storage.getCookie("optimizelyBuckets"),optimizelyEndUserId:o.utils.storage.getCookie("optimizelyEndUserId"),optimizelySegments:o.utils.storage.getCookie("optimizelySegments"),atlPath:o.utils.storage.getCookie("__atl_path")}}},t(function(){new o.sourcetree.Homepage})}(jQuery);